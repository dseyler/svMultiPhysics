<?xml version="1.0" encoding="UTF-8" ?>
<svMultiPhysicsFile version="0.1">

<GeneralSimulationParameters>
  <Continue_previous_simulation> 0 </Continue_previous_simulation>
  <Number_of_spatial_dimensions> 3 </Number_of_spatial_dimensions> 
  <Number_of_time_steps> 1000 </Number_of_time_steps> 
  <Time_step_size> 1e-3 </Time_step_size> 
  <Spectral_radius_of_infinite_time_step> 1.0 </Spectral_radius_of_infinite_time_step> 
  <Searched_file_name_to_trigger_stop> STOP_SIM </Searched_file_name_to_trigger_stop> 

  <Save_results_to_VTK_format> 1 </Save_results_to_VTK_format> 
  <Name_prefix_of_saved_VTK_files> result </Name_prefix_of_saved_VTK_files> 
  <!--Save_results_in_folder> results_svfsiplus </Save_results_in_folder-->
  <Increment_in_saving_VTK_files> 10 </Increment_in_saving_VTK_files> 
  <Start_saving_after_time_step> 1 </Start_saving_after_time_step> 

  <Increment_in_saving_restart_files> 10 </Increment_in_saving_restart_files> 
  <Convert_BIN_to_VTK_format> 0 </Convert_BIN_to_VTK_format> 

  <Verbose> 1 </Verbose> 
  <Warning> 1 </Warning> 
  <Debug> 1 </Debug> 

</GeneralSimulationParameters>


<Add_mesh name="msh" > 

  <Mesh_file_path> P1_0.005_Exact/mesh-complete.mesh.vtu </Mesh_file_path>

  <Add_face name="endo">
      <Face_file_path> P1_0.005_Exact/mesh-surfaces/endo.vtp </Face_file_path>
  </Add_face>

  <Add_face name="epi">
      <Face_file_path> P1_0.005_Exact/mesh-surfaces/epi.vtp </Face_file_path>
  </Add_face>

  <Add_face name="cap">
         <Face_file_path> P1_0.005_Exact/mesh-surfaces/cap.vtp </Face_file_path>
         <Virtual> true </Virtual> <!-- Flag for virtual capping surface -->
   </Add_face>

  <Add_face name="base">
      <Face_file_path> P1_0.005_Exact/mesh-surfaces/top.vtp </Face_file_path>
  </Add_face>

  <Fiber_direction_file_path> P1_0.005_Exact/fibersLong_elements.vtu </Fiber_direction_file_path>
  <Fiber_direction_file_path> P1_0.005_Exact/fibersSheet_elements.vtu </Fiber_direction_file_path>

</Add_mesh>


<!-- Using cgs units-->
<Add_equation type="struct" > 

   <Coupled> true </Coupled>
   <Min_iterations> 4 </Min_iterations>  
   <Max_iterations> 20 </Max_iterations> 
   <Tolerance> 1e-6 </Tolerance> 

   <Density> 1000 </Density>                           <!-- kg/m^3 -->
   <Elasticity_modulus> 1.0e6 </Elasticity_modulus>   <!-- Pa-->
   <Poisson_ratio> 0.49 </Poisson_ratio>

   <Viscosity model="Potential">
      <Value> 100.0 </Value> <!-- Pa.s -->
   </Viscosity>

   <Constitutive_model type="HolzapfelOgden-ModifiedAnisotropy">
      <a> 59.0 </a>                                   <!-- Pa -->
      <b> 8.023 </b>                                   <!-- no units -->
      <a4f> 18472.0 </a4f>
      <b4f> 16.026 </b4f>
      <a4s> 2481.0 </a4s>
      <b4s> 11.12 </b4s>
      <afs> 216.0 </afs>
      <bfs> 11.436 </bfs>
      <k> 100.0 </k> 
   </Constitutive_model>

   <Dilational_penalty_model> Quad </Dilational_penalty_model>
   <Penalty_parameter> 1.0e6 </Penalty_parameter>

   <Fiber_reinforcement_stress type="Unsteady" >
      <!-- Fiber stress in Pa (roughly similar values to active stress in Martin's paper)
      Generated by integrating ODE (Eq. 13 Martin paper) in Matlab
      The first row gives the number of time points and the number of desired
      Fourier coefficients to represent the data internally to svFSI -->
      <Temporal_values_file_path> fib_stress.dat </Temporal_values_file_path> 
      <Ramp_function> false </Ramp_function>
   </Fiber_reinforcement_stress>

   <Output type="Spatial" >
      <Displacement> true </Displacement>
      <Velocity> true </Velocity>
      <Acceleration> true </Acceleration>
      <Jacobian> true </Jacobian>
      <Stress> true </Stress>
      <Strain> true </Strain>
      <Cauchy_stress> true </Cauchy_stress>
      <Def_grad> true </Def_grad>
      <VonMises_stress> true </VonMises_stress>
   </Output>

   <LS type="GMRES" >
      <Linear_algebra type="fsils" >
         <Preconditioner> fsils </Preconditioner>
      </Linear_algebra> 
      <Tolerance> 1e-6 </Tolerance>
      <Max_iterations> 1000 </Max_iterations> 
      <Krylov_space_dimension> 50 </Krylov_space_dimension>
   </LS>

   <Couple_to_genBC type="I">
      <!-- Pressure returned by genBC is in dyne/cm^2 -->
      <ZeroD_code_file_path> genBC_svMultiPhysics/genBC.exe </ZeroD_code_file_path>
   </Couple_to_genBC>

   <Add_BC name="base" > 
      <Type> Robin </Type>
      <Time_dependence> Steady </Time_dependence> 
      <Stiffness> 1.0e5 </Stiffness>
      <Damping> 5.0e3 </Damping>
   </Add_BC>

   <Add_BC name="endo" > 
      <Type> Neu </Type> 
      <Time_dependence> Coupled </Time_dependence> 
      <Follower_pressure_load> true </Follower_pressure_load>
      <Capping_face> cap </Capping_face>    <!-- Specify capping surface for dVdt calculation on endo surface -->
   </Add_BC>

   <Add_BC name="epi" > 
      <Type> Robin </Type> 
      <Stiffness> 1.0e8 </Stiffness>
      <Damping> 5.0e3 </Damping>
      <Apply_along_normal_direction> 1 </Apply_along_normal_direction>
   </Add_BC>
   
</Add_equation>

</svMultiPhysicsFile>